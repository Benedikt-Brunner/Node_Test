<html>

<head>
    <title>
        Test


    </title>
    <link rel="shortcut icon" type="image/x-icon" href="site_favicon_16_1664892280095.ico" />
    <link rel="stylesheet" href="Tournaments.css">
</head>

<body onload = updadteTournaments()>


    <div class="butdiv">
        
    <h1>
        <a href="/">&lt/Sc Springer Bad KÃ¶nig></a>
    </h1>

    </div>

    <div class="nav">
        <button class="left10" onclick=move10left()>
            &lt&lt
        </button>
        <button class="left" onclick=moveleft()>
            &lt
        </button>
        <span class="Page">
            1
        </span>
        <button class="right" onclick=moveright()>
            >
        </button>
        <button class="right10" onclick=move10right()>
            >>
        </button>
    </div>

    <div class="Tournamentgrid">

    </div>


    <script>

        
let page = 1

function moveleft() {
    let span = document.getElementsByClassName("Page").item(0);
    if (page == 1) {
        return;
    } else {
        page--;
        span.innerHTML = page;
        updadteTournaments();
    }
}

function move10left() {
    let span = document.getElementsByClassName("Page").item(0);
    if (page <= 10) {
        page = 1;
        span.innerHTML = page;
        updadteTournaments();
    } else {
        page -= 10;
        span.innerHTML = page;
        updadteTournaments();
    }
}

function moveright() {
    let span = document.getElementsByClassName("Page").item(0);
    page++;
    span.innerHTML = page;
    updadteTournaments();
}

function move10right() {
    let span = document.getElementsByClassName("Page").item(0);
    page += 10;
    span.innerHTML = page;
    updadteTournaments();
}

        function updadteTournaments(){
            let grid = document.getElementsByClassName("Tournamentgrid").item(0);
            

            fetch('/gettour', {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' },

            })
                .then(response => response.text())
                .then(text => JSON.parse(text))
                .then(tournaments => {
                    let namearray = Array()
                    const fragment = document.createDocumentFragment();
                    for(let i = 0; i < tournaments.length; i++){
                        namearray.push(tournaments[i].Name)
                    }
                    let nameset = new Set(namearray)

                    for (let i = (page - 1) * 6; i <= (page * 6) - 1 && i < nameset.size; i++) {
                        console.log(i)
                        let sortednames = Array()
                        for(let k = 0; k < tournaments.length; k++){
                        if([...nameset][i] == tournaments[k].Name){
                            sortednames.push(tournaments[k].name)
                        }
                    }
                    
                        let element = document.createElement("div");
                        element.className = "Tournamentdiv"
                        let placement = document.createElement("div");
                        placement.className = "Placement"
                        element.innerHTML = `<div class="Name"> <h2><a href="/Tournaments/${i+2}">${[...nameset][i]}</a></h2>`
                            for(let k = 0; k < sortednames.length; k++){
                                placement.innerHTML += `<span id="placementid" data-place="${k+1}">${sortednames[k]}</span>`
                            }
                            element.appendChild(placement)
                        fragment.appendChild(element);
                    }
                    grid.innerHTML = ""
                    grid.appendChild(fragment)
                })

            

        }




    </script>
   
</body>

</html>